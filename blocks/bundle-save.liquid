<div class="bundle-save-wrapper color-{{ block.settings.color_scheme | default: 'scheme-1' }}">
  <style>
    .bundle-save-wrapper {
      padding-block-start: {{ block.settings.padding_block_start | default: 0 }}px;
      padding-block-end: {{ block.settings.padding_block_end | default: 0 }}px;
      padding-inline-start: {{ block.settings.padding_inline_start | default: 0 }}px;
      padding-inline-end: {{ block.settings.padding_inline_end | default: 0 }}px;
    }

    .bundle-save-header {
      margin-bottom: 16px;
    }

    .bundle-save-header h3 {
      margin: 0;
      font-family: {{ block.settings.heading_font }};
      font-size: {{ block.settings.heading_font_size }};
      font-weight: {{ block.settings.heading_weight }};
      text-transform: {{ block.settings.heading_case }};
      color: {{ block.settings.heading_color }};
    }

    .bundle-options {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 12px;
    }

    .bundle-option-wrapper {
      position: relative;
      padding-top: 14px;
    }

    .bundle-option {
      position: relative;
      border: 1px solid {{ block.settings.border_color | default: '#000' }};
      border-radius: {{ block.settings.corner_radius | default: 8 }}px;
      padding: 8px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      background-color: white;
      height: 100%;
    }

    .bundle-option.popular  {
       border-top-left-radius: 0;
      border-top-right-radius: 0;
    }

    .bundle-option.best-offer {
       border-top-left-radius: 0;
      border-top-right-radius: 0;
    }

    .bundle-option input[type="radio"] {
      position: absolute;
      opacity: 0;
      cursor: pointer;
    }

    .bundle-option.selected {
      border-color: {{ block.settings.selected_border_color | default: '#000' }};
      background-color: {{ block.settings.selected_bg_color | default: '#f9f9f9' }};
      border-width: 1px;
      border-bottom-width: 6px;
      padding-bottom: 3px;
    }

    .bundle-badge {
      position: absolute;
      top: -7px;
      left: 50%;
      transform: translateX(-50%);
      padding: 2px 16px;
      border-radius: {{ block.settings.corner_radius | default: 8 }}px;
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      z-index: 10;
      white-space: nowrap;
      width: 100%;
      display: inline-flex;
      justify-content: center;
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
    }

    .bundle-badge.popular {
      background-color: {{ block.settings.badge_popular_bg | default: '#FFD700' }};
      color: {{ block.settings.badge_popular_color | default: '#000' }};
      border: 1px solid {{ block.settings.badge_popular_bg | default: '#FFD700' }};
     
    }

    .bundle-badge.best-offer {
      background-color: {{ block.settings.badge_best_bg | default: '#FFD700' }};
      color: {{ block.settings.badge_best_color | default: '#000' }};
        border: 1px solid {{ block.settings.badge_best_bg | default: '#FFD700' }};
       
    }

    .bundle-option-inner {
      width: 100%;
    }

    .bundle-duration {
      margin-bottom: 4px;
      font-family: {{ block.settings.label_font }};
      font-size: {{ block.settings.label_font_size }};
      font-weight: {{ block.settings.label_weight }};
      text-transform: {{ block.settings.label_case }};
      color: {{ block.settings.label_color }};
    }

    .bundle-pricing {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      {% comment %} margin-bottom: 12px; {% endcomment %}
    }

    .bundle-original-price {
      font-size: 10px;
      color: #999;
      text-decoration: line-through;
    }

    .bundle-current-price {
      font-size: 12px;
      font-weight: 700;
      color: #000;
    }

    .bundle-image-wrapper {
      width: 100%;
      max-width: 120px;
      margin: 0 auto;
    }

    .bundle-image-wrapper img {
      width: 100%;
      height: auto;
      display: block;
    }
  </style>

  <div class="bundle-save-header">
    <h3>{{ block.settings.heading | default: 'BUNDLE & SAVE:' }}</h3>
  </div>

  <div class="bundle-options">
    {% for i in (1..3) %}
      {% assign option_index = forloop.index %}
      {% capture option_title %}option_{{ option_index }}_title{% endcapture %}
      {% capture option_original_price %}option_{{ option_index }}_original_price{% endcapture %}
      {% capture option_current_price %}option_{{ option_index }}_current_price{% endcapture %}
      {% capture option_image %}option_{{ option_index }}_image{% endcapture %}
      {% capture option_badge %}option_{{ option_index }}_badge{% endcapture %}
      
      {% if block.settings[option_title] != blank %}
        <div class="bundle-option-wrapper">
          {% if block.settings[option_badge] != 'none' %}
            <div class="bundle-badge {{ block.settings[option_badge] }}">
              {% if block.settings[option_badge] == 'popular' %}
                {{ block.settings.badge_popular_text | default: 'POPULAR' }}
              {% elsif block.settings[option_badge] == 'best-offer' %}
                {{ block.settings.badge_best_text | default: 'BEST OFFER' }}
              {% endif %}
            </div>
          {% endif %}

          <label class="bundle-option {{ block.settings[option_badge] }}" id="bundle-option-{{ option_index }}">
            <input 
              type="radio" 
              name="bundle_option" 
              value="option-{{ option_index }}"
              {% if option_index == 1 %}checked{% endif %}
            >

            <div class="bundle-option-inner">
              <div class="bundle-duration">
                {{ block.settings[option_title] }}
              </div>

              <div class="bundle-pricing">
                {% if block.settings[option_original_price] != blank %}
                  <span class="bundle-original-price">{{ block.settings[option_original_price] }}</span>
                {% endif %}
                <span class="bundle-current-price">{{ block.settings[option_current_price] }}</span>
              </div>

              {% if block.settings[option_image] != blank %}
                <div class="bundle-image-wrapper">
                  {{ block.settings[option_image] | image_url: width: 240 | image_tag: loading: 'lazy' }}
                </div>
              {% endif %}
            </div>
          </label>
        </div>
      {% endif %}
    {% endfor %}
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const bundleOptions = document.querySelectorAll('.bundle-option');
      const bundleRadios = document.querySelectorAll('input[name="bundle_option"]');

      bundleRadios.forEach(function(radio) {
        radio.addEventListener('change', function() {
          bundleOptions.forEach(opt => opt.classList.remove('selected'));
          if (this.checked) {
            this.closest('.bundle-option').classList.add('selected');
          }
        });
      });

      // Set initial state
      const checkedRadio = document.querySelector('input[name="bundle_option"]:checked');
      if (checkedRadio) {
        checkedRadio.closest('.bundle-option').classList.add('selected');
      }
    });
  </script>
</div>

{% schema %}
{
  "name": "Bundle & Save",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:settings.color_scheme",
      "default": "scheme-1"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "BUNDLE & SAVE:"
    },
    {
      "type": "header",
      "content": "t:content.typography"
    },
   
    {
      "type": "select",
      "id": "heading_font",
      "label": "Heading Font",
      "options": [
        {
          "value": "var(--font-body--family)",
          "label": "t:options.body"
        },
        {
          "value": "var(--font-subheading--family)",
          "label": "t:options.subheading"
        },
        {
          "value": "var(--font-heading--family)",
          "label": "t:options.heading"
        },
        {
          "value": "var(--font-accent--family)",
          "label": "t:options.accent"
        }
      ],
      "default": "var(--font-heading--family)"
    },
    {
      "type": "select",
      "id": "heading_font_size",
      "label": "Heading Size",
      "options": [
        {
          "value": "",
          "label": "t:options.default"
        },
        {
          "value": "0.875rem",
          "label": "14px"
        },
        {
          "value": "1rem",
          "label": "16px"
        },
        {
          "value": "1.125rem",
          "label": "18px"
        },
        {
          "value": "1.25rem",
          "label": "20px"
        },
        {
          "value": "1.5rem",
          "label": "24px"
        }
      ],
      "default": "1rem"
    },
    {
      "type": "select",
      "id": "heading_weight",
      "label": "Heading Font Weight",
      "options": [
        {
          "value": "300",
          "label": "t:options.light"
        },
        {
          "value": "400",
          "label": "t:options.regular"
        },
        {
          "value": "500",
          "label": "t:options.medium"
        },
        {
          "value": "600",
          "label": "t:options.semibold"
        },
        {
          "value": "700",
          "label": "t:options.bold"
        }
      ],
      "default": "700"
    },
    {
      "type": "select",
      "id": "heading_case",
      "label": "Heading Case",
      "options": [
        {
          "value": "none",
          "label": "t:options.default"
        },
        {
          "value": "uppercase",
          "label": "t:options.uppercase"
        }
      ],
      "default": "none"
    },
       {
      "type": "select",
      "id": "label_font",
      "label": "Label Font",
      "options": [
        {
          "value": "var(--font-body--family)",
          "label": "t:options.body"
        },
        {
          "value": "var(--font-subheading--family)",
          "label": "t:options.subheading"
        },
        {
          "value": "var(--font-heading--family)",
          "label": "t:options.heading"
        },
        {
          "value": "var(--font-accent--family)",
          "label": "t:options.accent"
        }
      ],
      "default": "var(--font-heading--family)"
    },
    {
      "type": "select",
      "id": "label_font_size",
      "label": "Label Size",
      "options": [
        {
          "value": "",
          "label": "t:options.default"
        },
        {
          "value": "0.625rem",
          "label": "10px"
        },
        {
          "value": "0.75rem",
          "label": "12px"
        },
        {
          "value": "0.875rem",
          "label": "14px"
        },
        {
          "value": "1rem",
          "label": "16px"
        },
        {
          "value": "1.125rem",
          "label": "18px"
        },
        {
          "value": "1.25rem",
          "label": "20px"
        },
        {
          "value": "1.5rem",
          "label": "24px"
        }
      ],
      "default": "1rem"
    },
    {
      "type": "select",
      "id": "label_weight",
      "label": "Label Font Weight",
      "options": [
        {
          "value": "300",
          "label": "t:options.light"
        },
        {
          "value": "400",
          "label": "t:options.regular"
        },
        {
          "value": "500",
          "label": "t:options.medium"
        },
        {
          "value": "600",
          "label": "t:options.semibold"
        },
        {
          "value": "700",
          "label": "t:options.bold"
        }
      ],
      "default": "700"
    },
    {
      "type": "select",
      "id": "label_case",
      "label": "Label Case",
      "options": [
        {
          "value": "none",
          "label": "t:options.default"
        },
        {
          "value": "uppercase",
          "label": "t:options.uppercase"
        }
      ],
      "default": "none"
    },
    {
      "type": "header",
      "content": "Option 1"
    },
    {
      "type": "text",
      "id": "option_1_title",
      "label": "Title",
      "default": "1 month supply"
    },
    {
      "type": "text",
      "id": "option_1_original_price",
      "label": "Original Price",
      "default": "$69.00"
    },
    {
      "type": "text",
      "id": "option_1_current_price",
      "label": "Current Price",
      "default": "$39.99"
    },
    {
      "type": "image_picker",
      "id": "option_1_image",
      "label": "Image"
    },
    {
      "type": "select",
      "id": "option_1_badge",
      "label": "Badge",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "popular",
          "label": "Popular"
        },
        {
          "value": "best-offer",
          "label": "Best Offer"
        }
      ],
      "default": "none"
    },
    {
      "type": "header",
      "content": "Option 2"
    },
    {
      "type": "text",
      "id": "option_2_title",
      "label": "Title",
      "default": "3 month supply"
    },
    {
      "type": "text",
      "id": "option_2_original_price",
      "label": "Original Price",
      "default": "$89.99"
    },
    {
      "type": "text",
      "id": "option_2_current_price",
      "label": "Current Price",
      "default": "$54.99"
    },
    {
      "type": "image_picker",
      "id": "option_2_image",
      "label": "Image"
    },
    {
      "type": "select",
      "id": "option_2_badge",
      "label": "Badge",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "popular",
          "label": "Popular"
        },
        {
          "value": "best-offer",
          "label": "Best Offer"
        }
      ],
      "default": "popular"
    },
    {
      "type": "header",
      "content": "Option 3"
    },
    {
      "type": "text",
      "id": "option_3_title",
      "label": "Title",
      "default": "6 month supply"
    },
    {
      "type": "text",
      "id": "option_3_original_price",
      "label": "Original Price",
      "default": "$99.99"
    },
    {
      "type": "text",
      "id": "option_3_current_price",
      "label": "Current Price",
      "default": "$66.99"
    },
    {
      "type": "image_picker",
      "id": "option_3_image",
      "label": "Image"
    },
    {
      "type": "select",
      "id": "option_3_badge",
      "label": "Badge",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "popular",
          "label": "Popular"
        },
        {
          "value": "best-offer",
          "label": "Best Offer"
        }
      ],
      "default": "best-offer"
    },
    {
      "type": "header",
      "content": "Badge Settings"
    },
    {
      "type": "text",
      "id": "badge_popular_text",
      "label": "Popular Badge Text",
      "default": "POPULAR"
    },
    {
      "type": "color",
      "id": "badge_popular_bg",
      "label": "Popular Badge Background",
      "default": "#FFD700"
    },
    {
      "type": "color",
      "id": "badge_popular_color",
      "label": "Popular Badge Text Color",
      "default": "#000000"
    },
    {
      "type": "text",
      "id": "badge_best_text",
      "label": "Best Offer Badge Text",
      "default": "BEST OFFER"
    },
    {
      "type": "color",
      "id": "badge_best_bg",
      "label": "Best Offer Badge Background",
      "default": "#FFD700"
    },
    {
      "type": "color",
      "id": "badge_best_color",
      "label": "Best Offer Badge Text Color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Styling"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "selected_border_color",
      "label": "Selected Border Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "selected_bg_color",
      "label": "Selected Background Color",
      "default": "#f9f9f9"
    },
    {
      "type": "range",
      "id": "corner_radius",
      "label": "Corner Radius",
      "min": 0,
      "max": 20,
      "step": 1,
      "unit": "px",
      "default": 8
    },
    {
      "type": "header",
      "content": "Padding"
    },
    {
      "type": "range",
      "id": "padding_block_start",
      "label": "Top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_block_end",
      "label": "Bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_inline_start",
      "label": "Left",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_inline_end",
      "label": "Right",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    }
  ],
  "presets": [
    {
      "name": "Bundle & Save",
      "category": "t:categories.product"
    }
  ]
}
{% endschema %}
